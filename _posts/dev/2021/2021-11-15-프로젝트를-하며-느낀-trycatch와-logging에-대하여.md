---
layout: post
title: 프로젝트를 하며 느낀 try_catch와 logging에 대하여.
date: 2021-11-15
categories: dev
---

한동안 블로그에 전혀 글을 작성하지 않았지만, 약 한 달 반 정도 디스코드 봇을 개발하고 있었습니다.

개발하면서 많은 시행착오를 겪으며 배운 것들이 물론 많지만, 특히 이번에 겪은 에러는 전혀 생각하지 못했던 부분을 툭 맞은 느낌이라 겪은 순간부터 "아, 이건 블로깅 해야겠다"라고 생각했고, 이틀 정도 뒤인 오늘 적게 되었습니다.

---

## 믹스테잎 봇이란?

믹스테잎 봇은 로스트아크라는 게임을 플레이하면서 만든 유틸리티 봇입니다.
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여.png){: style="width: 40%;"}

게임을 하는 도중에 여유 시간이 그리 많지 않은 상황에서 브라우저를 키고 특정 사이트를 들어가고, 닉네임을 검색하는 것이 불편해서 항시 켜져있는 디스코드에서 처리하는 게 훨씬 좋을 것 같아 만들게 되었습니다.

---

## 예상치 못한 성공, 그리고 예상치 못한 에러

### 폭발적인 반응

나름 열심히 만들었지만, 만들면서도 "아, 코드 진짜 더러운 건 아는데 일단 구현만 해놓고, 리팩토링하면서 나중에 다 분리해야겠다"고 생각해놓고 아직 안 하고 있긴 합니다. (사실 애초에 지금은 개발 시간엔 이슈 들어온 거 해결하고 있어서...)

그렇게 꾸역꾸역 만들었다는 표현이 더 적절한 봇이더라도, 로스트아크 인벤에 올렸을 때 꽤나 큰 호응을 얻었습니다.

https://www.inven.co.kr/board/lostark/4811/3541376
- 조회수 16,637
- 추천 172개 (21.11.15 기준)

**공개한 지 30분 만에 디스코드 측에서 제공한 250개의 서버 할당량을 모두 채워버렸고**, 서버 좀 더 열어달라고 디스코드 DM창이 불탔었습니다.

이렇게까지 잘될 줄 몰랐는데...
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-1.png)*제가 어찌 할 방도가 없었습니다..*
### 생각지도 못한 입력값

이미 250개의 서버에서 믹스테잎 봇을 데려가서 사용 중이었지만, 직접 사용해보고 싶다는 사람이 생겨서 배포되어있는 믹스테잎과 기능은 똑같지만 제가 켜야만 작동하는 개발용 봇을 잠깐 켜주기로 했었습니다.

그런데...
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-2.png){: style="width: 50%;"}
**사용자가 닉네임을 `[예능]` 이렇게 검색했습니다.**

용례를 안 적긴 했지만, 정말 닉네임을 저렇게 검색할 줄 상상도 못 했었습니다. 그렇다 보니 그에 따른 오류가 발생했을 때 처리를 못 걸어놨었는데...
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-3.png)

**MessageEmbed는 빈 문자열이 들어가면 안 된다고 에러가 나면서 봇이 멈춰버렸습니다.**

DM을 준 이분을 제외하면 닉네임 양옆에 대괄호를 쳐서 검색한 적이 없었는지, 다행히 배포했던 봇에서는 해당 오류가 발생하지 않았습니다. 하지만 봇이 멈추는 것을 대비하기 위해 오류를 찾은 즉시 최대한 빨리 작업해야 했습니다.

---

## 깨달음: 예외 처리의 중요성

### 기본을 놓쳤다

분명히 부트캠프에서 공부할 때 `try-catch`를 배웠지만, 막상 제대로 사용한 경험이 없어 생각지도 못했었습니다.

기능적으로 무언가 return이 발생한 부분이라면 응당:

1. **오류가 났을 때에도 멈추지 않고 계속 이어갈 수 있도록** 잡아줘야 하고
2. 개발자가 바로바로 확인은 못 하더라도 나중에 **로그를 찾아보고 오류를 수정할 수 있게끔 기록**을 해줘야 했습니다.

그 기본적인 것들을 하지 않고 그저 기능 개발에만 집중했었던 것입니다.

### 개선 작업

#### 1) 사용자에게 에러 알림
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-5.png)
만약 기능에 에러가 발생했을 때, 사용자에게 에러가 발생했다고 알려주고 (어차피 사유는 알려주지 못하지만) 혹여나 입력값을 잘못 입력했는지 확인할 수 있도록 하는 문구를 추가했습니다.

#### 2) 에러 로깅
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-6.png)
![](2021-11-15-프로젝트를-하며-느낀-trycatch와-logging에-대하여-4.png)

나중에 로그를 보고 어떤 명령을 하면 어떤 에러가 언제 발생했는지 알 수 있도록 Node.js의 File System을 사용하여 기록하는 기능도 추가했습니다.

---

## 개발자로서의 실력

개발자 3~4년 차인 친구들에게 물어봤습니다.

"에러가 발생할 가능성이 있는 대부분의 기능에 이러한 작업을 해주어야 하느냐고."

알고도 물어봤지만, 친구들은 당연하게도 **이걸 다 고려해가면서 개발하는 게 개발자의 실력**이라고, 그래서 애초에 **작업을 시작하기 전에 그런 걸 다 설계해서 만드는 게 필요**하다고 했습니다.

뭐, 위로하려고 하는 말인지는 모르겠지만 본인들의 연차(3~4년)들이 겪고 심각하게 고민하는 부분이라고는 하지만, 제가 느끼기엔 그냥 애초에 해야 하는 걸 까먹고 안 한 느낌이어서 너무 찝찝했습니다.

---

## 마치며

### 배운 점

1. **예외 처리는 선택이 아닌 필수입니다.**
    - 사용자의 입력은 예측할 수 없습니다.
    - 모든 가능성을 고려해야 합니다.
2. **에러 로깅은 디버깅의 시작입니다.**
    - 에러가 발생했을 때 언제, 어디서, 왜 발생했는지 기록해야 합니다.
    - 나중에 비슷한 문제가 발생했을 때 빠르게 대응할 수 있습니다.
3. **설계의 중요성을 깨달았습니다.**
    - "일단 구현하고 나중에 고치자"는 좋지 않은 습관입니다.
    - 처음부터 예외 처리를 염두에 두고 설계해야 합니다.

이번 경험을 통해 "기능이 작동한다"와 "안정적으로 작동한다"는 완전히 다른 차원의 문제라는 것을 배웠습니다.

앞으로는 기능 개발뿐만 아니라 예외 처리와 에러 핸들링에도 더 신경 써야겠다고 다짐했습니다.